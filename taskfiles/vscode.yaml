version: "3"

tasks:
  uninstall-extensions:
    aliases: [ue]
    cmds:
      - >
        diff <(code --list-extensions | sort) <(tomlq -r '.extensions[]' ./extensions.toml | sort) |
        grep '<' |
        sed 's/^< //g' |
        xargs -n 1 code --uninstall-extension

  install-extensions:
    aliases: [ie]
    cmds:
      - >
        diff <(code --list-extensions | sort) <(tomlq -r '.extensions[]' ./extensions.toml | sort) |
        grep '>' |
        sed 's/^> //g' |
        xargs -n 1 code --install-extension

  sync-extensions:
    aliases: [se]
    deps: [uninstall-extensions, install-extensions]
    cmds:
      - code --update-extensions
